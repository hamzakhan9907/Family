<!DOCTYPE html>
<html lang="ur">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: sans-serif; background: #2c3e50; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .admin-box { background: white; padding: 30px; border-radius: 10px; width: 300px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        h2 { color: #333; }
        input { width: 90%; padding: 12px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; font-size: 16px; }
        button { width: 100%; padding: 12px; background: #e74c3c; color: white; border: none; border-radius: 5px; font-size: 16px; font-weight: bold; cursor: pointer; }
        button:hover { background: #c0392b; }
        .back-link { display: block; margin-top: 15px; color: #555; text-decoration: none; font-size: 14px; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div class="admin-box">
        <h2>Admin Settings</h2>
        
        <label style="font-weight:bold; display:block; text-align:left;">Website Name Change:</label>
        <input type="text" id="newName" placeholder="Naya naam likhein...">
        <button onclick="updateName()">Update Name</button>
        
        <br><br>
        <a href="index.html" class="back-link">‚Üê Wapis Website Par Jayein</a>
    </div>

    <script>
        const supabaseUrl = 'https://ojphjodmpyblyfyinacb.supabase.co';
        const k1 = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9qcGhqb2RtcHlibHlmeWluYWN";
        const k2 = "iIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ0MTUwNTAsImV4cCI6MjA3OTk5MTA1MH0";
        const k3 = ".mwKu_g5_OT_89KcAeeSsY8IMlnakV2nQVtKRhWWTcDw";
        const supabaseKey = k1 + k2 + k3;

        const _supabase = supabase.createClient(supabaseUrl, supabaseKey, { auth: { persistSession: false } });

        // --- SECURITY CHECK (Simple Password) ---
        // Jab page khulega, Password mangega
        const password = prompt("Admin Password likhein:");
        if (password !== "12345") { // Yahan password change kar sakte hain
            alert("Ghalat Password!");
            window.location.href = "index.html"; // Wapis bhej do
        } else {
            // Agar password sahi hai, to purana naam load karo
            loadCurrentName();
        }

        // Naam Load karna
        async function loadCurrentName() {
            const { data } = await _supabase.from('site_config').select('site_name').limit(1);
            if (data && data[0]) {
                document.getElementById('newName').value = data[0].site_name;
            }
        }

        // Naam Update karna
        async function updateName() {
            const newName = document.getElementById('newName').value;
            if (!newName) return alert("Naam khali nahi ho sakta!");

            // Hum maan ke chal rahe hain ke ID = 1 hai (kyunki pehli row hai)
            // 'site_config' table mein update kar rahe hain
            const { error } = await _supabase
                .from('site_config')
                .update({ site_name: newName })
                .eq('id', 1); // Sirf ID 1 ko update karo (Pehli row)

            if (error) {
                alert("Error: " + error.message);
            } else {
                alert("Naam change ho gaya!");
                window.location.href = "index.html"; // Home page par wapis jao
            }
        }
    </script>
</body>
</html>